---
layout: post
title: 一起来做chrome扩展《AJAX请求》
category: chrome扩展
description: chrome在一次更新之后，出于安全考虑，完全的禁止了content_script从https向http发起ajax请求，即使正常情况下也会在console里给出提示。这对于WEB来讲是好事，但对于扩展来讲就是坏事。平时可以很容易的请求数据，现在就没那么容易了
img: 201501/01.png
keywords: chrome,extensions,ajax,扩展,基础
---

<p>
chrome在一次更新之后，出于安全考虑，完全的禁止了content_script从https向http发起ajax请求，即使正常情况下也会在console里给出提示。这对于WEB来讲是好事，但对于扩展来讲就是坏事。平时可以很容易的请求数据，现在就没那么容易了。好在chrome还提供了background_script，利用content_script和background_script之前的通信来实现ajax的请求，就跳过了chrome的这一限制。
</p>
<h2 class="content_h2">
content_script
</h2>
<p>
从名字里就知道，content_script是植入型的，它会被植入到符合匹配的网站页面上。在页面加载完成后执行。content_script最有用的地方是操作网站页面上的DOM。一切平时做前端的一些操作它都可以做，像什么添加、修改、删除DOM，获取DOM值，监听事件等等，都可以很容易的做到。所以，如果想获取人家的登录帐户和密码，就是件非常容易的事，只需要添加content_script，监听帐户和密码的文本框，获得值后将数据发送到自己的服务器就可以了。因此，<strong>特别说明，别乱装扩展，特别是不从官方扩展库里下载的扩展。</strong>
</p>
<h2 class="content_h2">
background_script
</h2>
<p>
它在chrome扩展启动的时候就启动了，做着它的事，而且等待着你给他的指令。它没办法控制页面元素，但可以通过content_script告诉它。ajax同理，如果要在页面打开时向别的服务器请求数据，这时就可以告诉background_script，让它去请求，然后把返回的数据发送给content_script。这样就不会受到浏览器的安全限制影响。
</p>
<h3>
使用background_script
</h3>
<p>
要使用background_script，需要在manifest.json中配置，如下：
</p>
<pre class="prettyprint lang-python">
{
	"manifest_version": 2,
	"name": "My Extension",
	"description": "Extension description",
	"version": "1.0",

	"background": {
		"scripts": [
			"background.js"
		]
	}
}
</pre>
<script type="text/javascript">
jQuery(function($){
    window.prettyPrint && prettyPrint();
});
</script>
